<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîç Verificar Jogos - Console</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #1a1a1a;
            color: #fff;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        .header {
            background: linear-gradient(135deg, #ff8000 0%, #ff6000 100%);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 30px;
        }
        .section {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 2px solid rgba(255, 128, 0, 0.3);
        }
        .status {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            margin: 5px;
        }
        .status.success { background: #51cf66; color: #000; }
        .status.error { background: #ff6b6b; color: #fff; }
        .status.warning { background: #ffd43b; color: #000; }
        .code {
            background: #000;
            padding: 15px;
            border-radius: 5px;
            border-left: 4px solid #ff8000;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
        }
        .loading {
            text-align: center;
            padding: 20px;
        }
        .spinner {
            border: 5px solid rgba(255, 255, 255, 0.1);
            border-top: 5px solid #ff8000;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .result {
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .result.ok { background: rgba(81, 207, 102, 0.2); border-left: 4px solid #51cf66; }
        .result.fail { background: rgba(255, 107, 107, 0.2); border-left: 4px solid #ff6b6b; }
        button {
            background: linear-gradient(135deg, #ff8000 0%, #ff6000 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin: 10px 5px;
        }
        button:hover {
            transform: scale(1.05);
        }
        pre {
            white-space: pre-wrap;
            word-wrap: break-word;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üîç DIAGN√ìSTICO - Por que os jogos n√£o aparecem?</h1>
        <p>Verifica√ß√£o completa do sistema</p>
    </div>

    <div class="section">
        <h2>üìä Status Geral</h2>
        <div id="status-geral">
            <div class="loading">
                <div class="spinner"></div>
                <p>Verificando sistema...</p>
            </div>
        </div>
    </div>

    <div class="section">
        <h2>üîå 1. Teste da API</h2>
        <button onclick="testarAPI()">üîÑ Testar API Agora</button>
        <div id="resultado-api"></div>
    </div>

    <div class="section">
        <h2>üíæ 2. Verificar Banco de Dados</h2>
        <button onclick="testarBanco()">üîÑ Verificar Banco</button>
        <div id="resultado-banco"></div>
    </div>

    <div class="section">
        <h2>üé® 3. Verificar Vue.js</h2>
        <button onclick="testarVue()">üîÑ Verificar Vue</button>
        <div id="resultado-vue"></div>
    </div>

    <div class="section">
        <h2>üõ†Ô∏è 4. Solu√ß√£o R√°pida</h2>
        <div id="solucao"></div>
    </div>

    <script>
        // Executar verifica√ß√£o autom√°tica ao carregar
        window.onload = function() {
            verificarTudo();
        };

        async function verificarTudo() {
            await testarAPI();
            await testarBanco();
            await testarVue();
            gerarSolucao();
        }

        async function testarAPI() {
            const div = document.getElementById('resultado-api');
            div.innerHTML = '<div class="loading"><div class="spinner"></div><p>Testando API...</p></div>';

            try {
                const response = await fetch('/Cliente/LeagueBetCliente-main/apostar/jogos');
                const contentType = response.headers.get('content-type');
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                if (!contentType || !contentType.includes('application/json')) {
                    throw new Error(`API retornou ${contentType} ao inv√©s de JSON!`);
                }

                const data = await response.json();

                let html = '<div class="result ok">';
                html += '<h3>‚úÖ API Funcionando!</h3>';
                html += `<p><strong>Status HTTP:</strong> ${response.status}</p>`;
                html += `<p><strong>Content-Type:</strong> ${contentType}</p>`;
                html += `<p><strong>Total de Cota√ß√µes:</strong> ${data.cotacoes?.length || 0}</p>`;
                html += `<p><strong>Total de Pa√≠ses:</strong> ${data.paises?.length || 0}</p>`;
                
                // Contar jogos
                let totalJogos = 0;
                if (data.paises && Array.isArray(data.paises)) {
                    data.paises.forEach(pais => {
                        if (pais.campeonatos && Array.isArray(pais.campeonatos)) {
                            pais.campeonatos.forEach(camp => {
                                if (camp.jogos && Array.isArray(camp.jogos)) {
                                    totalJogos += camp.jogos.length;
                                }
                            });
                        }
                    });
                }
                
                html += `<p><strong>Total de Jogos:</strong> ${totalJogos}</p>`;
                
                if (totalJogos === 0) {
                    html += '<div class="result fail" style="margin-top: 15px;">';
                    html += '<h4>‚ö†Ô∏è PROBLEMA ENCONTRADO!</h4>';
                    html += '<p>A API est√° funcionando, mas <strong>n√£o h√° jogos dispon√≠veis</strong>!</p>';
                    html += '<p><strong>Solu√ß√£o:</strong> Importar jogos do banco de dados.</p>';
                    html += '</div>';
                } else {
                    html += '<div class="code">';
                    html += '<strong>Exemplo de Jogo:</strong><br>';
                    const primeiroJogo = data.paises[0]?.campeonatos[0]?.jogos[0];
                    if (primeiroJogo) {
                        html += `${primeiroJogo.casa} x ${primeiroJogo.fora}<br>`;
                        html += `Data: ${primeiroJogo.data} ${primeiroJogo.hora}<br>`;
                        html += `Campeonato: ${primeiroJogo.campeonato}`;
                    }
                    html += '</div>';
                }
                
                html += '</div>';
                div.innerHTML = html;

                // Salvar resultado
                window.apiOk = true;
                window.totalJogos = totalJogos;

            } catch (error) {
                let html = '<div class="result fail">';
                html += '<h3>‚ùå Erro na API!</h3>';
                html += `<p><strong>Erro:</strong> ${error.message}</p>`;
                html += '<p><strong>URL testada:</strong> /Cliente/LeagueBetCliente-main/apostar/jogos</p>';
                html += '</div>';
                div.innerHTML = html;

                window.apiOk = false;
                window.apiError = error.message;
            }
        }

        async function testarBanco() {
            const div = document.getElementById('resultado-banco');
            div.innerHTML = '<div class="loading"><div class="spinner"></div><p>Verificando banco...</p></div>';

            try {
                const response = await fetch('/Cliente/LeagueBetCliente-main/teste-jogos-direto.php');
                const text = await response.text();

                let html = '<div class="result ok">';
                html += '<h3>‚úÖ Banco de Dados Acess√≠vel</h3>';
                
                // Extrair informa√ß√µes do resultado
                const totalMatch = text.match(/Total de jogos dispon√≠veis[^\d]*(\d+)/i);
                const jogosMatch = text.match(/Pr√≥ximos (\d+) Jogos/i);
                
                if (totalMatch) {
                    const total = parseInt(totalMatch[1]);
                    html += `<p><strong>Jogos no banco (futuros):</strong> ${total}</p>`;
                    window.jogosBanco = total;
                    
                    if (total === 0) {
                        html += '<div class="result fail" style="margin-top: 15px;">';
                        html += '<h4>‚ö†Ô∏è PROBLEMA ENCONTRADO!</h4>';
                        html += '<p>N√£o h√° jogos futuros no banco de dados!</p>';
                        html += '<p><strong>Solu√ß√£o:</strong> Importar jogos novos da API externa.</p>';
                        html += '</div>';
                    }
                }
                
                html += '</div>';
                div.innerHTML = html;

            } catch (error) {
                let html = '<div class="result fail">';
                html += '<h3>‚ùå Erro ao acessar banco!</h3>';
                html += `<p><strong>Erro:</strong> ${error.message}</p>`;
                html += '</div>';
                div.innerHTML = html;
            }
        }

        function testarVue() {
            const div = document.getElementById('resultado-vue');
            
            let html = '<div class="result ok">';
            html += '<h3>üìã Verifica√ß√£o do Vue.js</h3>';
            
            // Verificar se Vue est√° carregado
            if (typeof Vue !== 'undefined') {
                html += '<p>‚úÖ <strong>Vue.js:</strong> Carregado</p>';
            } else {
                html += '<p>‚ùå <strong>Vue.js:</strong> N√ÉO carregado!</p>';
            }
            
            // Verificar se Axios est√° carregado
            if (typeof axios !== 'undefined') {
                html += '<p>‚úÖ <strong>Axios:</strong> Carregado</p>';
            } else {
                html += '<p>‚ùå <strong>Axios:</strong> N√ÉO carregado!</p>';
            }
            
            // Instru√ß√µes para verificar no site principal
            html += '<div class="code" style="margin-top: 15px;">';
            html += '<strong>Para verificar no site principal:</strong><br>';
            html += '1. Abra: http://localhost/Cliente/LeagueBetCliente-main/<br>';
            html += '2. Pressione F12 (abrir console)<br>';
            html += '3. V√° na aba "Console"<br>';
            html += '4. Procure por erros em vermelho<br>';
            html += '5. Digite: <code>app.paises</code> e pressione Enter<br>';
            html += '6. Deve mostrar um Array com os pa√≠ses/jogos';
            html += '</div>';
            
            html += '</div>';
            div.innerHTML = html;
        }

        function gerarSolucao() {
            const div = document.getElementById('solucao');
            
            let html = '<h3>üéØ Diagn√≥stico e Solu√ß√£o</h3>';
            
            if (!window.apiOk) {
                html += '<div class="result fail">';
                html += '<h4>‚ùå Problema: API n√£o est√° respondendo</h4>';
                html += '<p><strong>Causa:</strong> ' + (window.apiError || 'Erro desconhecido') + '</p>';
                html += '<p><strong>Solu√ß√£o:</strong></p>';
                html += '<ol>';
                html += '<li>Verifique se o Apache est√° rodando</li>';
                html += '<li>Verifique se o MySQL est√° rodando</li>';
                html += '<li>Teste acessar: <a href="/Cliente/LeagueBetCliente-main/apostar/jogos" target="_blank">/apostar/jogos</a></li>';
                html += '</ol>';
                html += '</div>';
            } else if (window.totalJogos === 0) {
                html += '<div class="result fail">';
                html += '<h4>‚ö†Ô∏è Problema: N√£o h√° jogos dispon√≠veis</h4>';
                html += '<p><strong>Causa:</strong> O banco de dados n√£o tem jogos futuros ou ativos.</p>';
                html += '<p><strong>Solu√ß√£o:</strong></p>';
                html += '<ol>';
                html += '<li><strong>Importar jogos agora:</strong><br>';
                html += '<a href="/Cliente/LeagueBetCliente-main/importar-agora.php" target="_blank" style="color: #ff8000; font-weight: bold;">‚Üí Clique aqui para importar jogos</a></li>';
                html += '<li>Ou execute via terminal:<br>';
                html += '<code style="background: #000; padding: 5px; display: block; margin: 5px 0;">C:\\xampp\\php\\php.exe jogos.php</code></li>';
                html += '<li>Aguarde a importa√ß√£o concluir (pode levar 1-2 minutos)</li>';
                html += '<li>Recarregue a p√°gina principal (Ctrl + F5)</li>';
                html += '</ol>';
                html += '</div>';
            } else {
                html += '<div class="result ok">';
                html += '<h4>‚úÖ Sistema OK - Jogos devem estar aparecendo!</h4>';
                html += `<p>H√° <strong>${window.totalJogos} jogos</strong> dispon√≠veis na API.</p>';
                html += '<p><strong>Se os jogos N√ÉO est√£o aparecendo no site:</strong></p>';
                html += '<ol>';
                html += '<li>Limpe o cache do navegador (Ctrl + Shift + Delete)</li>';
                html += '<li>Recarregue a p√°gina (Ctrl + F5)</li>';
                html += '<li>Abra o Console (F12) e procure por erros</li>';
                html += '<li>Verifique se o Vue.js est√° carregando os dados:<br>';
                html += '<code style="background: #000; padding: 5px; display: block; margin: 5px 0;">Digite no console: app.paises</code></li>';
                html += '</ol>';
                html += '</div>';
            }
            
            html += '<div style="margin-top: 20px; padding: 15px; background: rgba(255, 128, 0, 0.1); border-radius: 5px;">';
            html += '<h4>üîó Links √öteis:</h4>';
            html += '<ul>';
            html += '<li><a href="/Cliente/LeagueBetCliente-main/" target="_blank" style="color: #ff8000;">‚Üí Abrir Site Principal</a></li>';
            html += '<li><a href="/Cliente/LeagueBetCliente-main/apostar/jogos" target="_blank" style="color: #ff8000;">‚Üí Testar API (JSON)</a></li>';
            html += '<li><a href="/Cliente/LeagueBetCliente-main/importar-agora.php" target="_blank" style="color: #ff8000;">‚Üí Importar Jogos</a></li>';
            html += '<li><a href="/Cliente/LeagueBetCliente-main/teste-visual-jogos.html" target="_blank" style="color: #ff8000;">‚Üí Visualiza√ß√£o de Teste</a></li>';
            html += '</ul>';
            html += '</div>';
            
            div.innerHTML = html;
            
            // Atualizar status geral
            const statusDiv = document.getElementById('status-geral');
            let statusHtml = '';
            
            if (window.apiOk && window.totalJogos > 0) {
                statusHtml = '<div class="result ok">';
                statusHtml += '<h3>‚úÖ Sistema Funcionando!</h3>';
                statusHtml += `<p>${window.totalJogos} jogos dispon√≠veis</p>`;
                statusHtml += '</div>';
            } else {
                statusHtml = '<div class="result fail">';
                statusHtml += '<h3>‚ö†Ô∏è A√ß√£o Necess√°ria</h3>';
                statusHtml += '<p>Veja a se√ß√£o "Solu√ß√£o R√°pida" abaixo</p>';
                statusHtml += '</div>';
            }
            
            statusDiv.innerHTML = statusHtml;
        }
    </script>
</body>
</html>

